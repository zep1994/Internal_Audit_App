<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Upload Example</title>
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.css">
        <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
</head>

<!-- Add Header Section -->
<div id="header_adder" class="header_adder">
    <button id="header_button" class="header_button">Add Section +</button>
</div>
<!-- Header Section  -->
<div id="header_section" class="header_section">
    <span class="header_section_list">

    </span>
</div>


<form id="upload-widget" method="post" action="/public/uploads" class="dropzone" enctype="multipart/form-data">
    <div class="fallback">
        <input name="file" type="file" id="file" />
    </div>
</form>

<div class="files"></div>

<body>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.js"></script>
    <script type="text/javascript">
            Dropzone.options.uploadWidget = {
                url: '/public/uploads',
                acceptedFiles: "image/*,application/pdf,.doc,.docx,.xls,.xlsx,.csv,.tsv,.ppt,.pptx,.pages,.odt,.rtf",
                dictDefaultMessage: 'Drag File To Upload',
                addRemoveLinks: true,
                    init: function() {
                        let myDropzone = this;
                        myDropzone.on('success', function(file, response) {
                            var a = document.createElement('a');
                            a.setAttribute('href',"/uploads/" + file.name);
                            a.setAttribute('target', "_blank")
                           //a.append('http://localhost:3000/public/uploads/'+file)
                            a.innerHTML = "<br>download";
                            file.previewTemplate.appendChild(a);
                            //file.previewTemplate.appendChild(document.createTextNode(file.file));
                            //console.log(file, response)
                        })
                    }
                }

    </script>

    <script>
        $(document).ready(function() {
            var header_counter = 2
            $('#header_button').on('click', function() {
                $('#header_section').append('<div id="header_section'+header_counter+'" class="header_section'+header_counter+'">\
                        Section Header Field <br>\
                        <div class="section_area">\
                            Section Area Field   <button id="section_area_adder1" class="section_area_header1">+</button> <br>\
                        </div>\
                    </div>\
                    <hr>\
                ')
                header_counter++
            })

            $(document).on('click', '[id^=section_area_adder]', function() {
                var counter = 2
                var id = $(this).attr('id')
                console.log(id)
                var id_num = id.slice(-1)
                console.log(id_num)
                $(this).parent().append('Section Area Field    <button id="section_area_adder'+counter+'" class="section_area_adder">+</button> <br>')
                counter++
            })
        })
    </script>
</body>
</html>
<!-- 

$('#section_area_adder1').on('click', '.section_area_header', function() {
    var counter = 2
    var id = $(this).attr('id')
    console.log(id)
    var id_num = id.slice(-1)
    console.log(id_num)
    $('.section_area').append('Section Area Field    <button id="section_area_adder'+counter+'" class="section_area_adder">+</button> <br>')
    counter++
}) -->

<!-- $(document).ready(function() {
    $.ajax({
        url: '/upload',
        method: 'post',
        data: { file: 'file'},
        success: function(data) {
            var a = document.createElement('a');
            a.setAttribute('href',"/uploads/" + data.file);
            a.innerHTML = "<br>download";
            file.previewTemplate.appendChild(a);
        }
    })
}) -->


<!-- 
$(".dropzone").on('change', function() {
    $.ajax({
        url: '/upload',
        method: 'post',
        dataType: 'json',
        data: { 'file': 'file' },
        success: function(response) {
            console.log(file)
        }
    })
}) -->

<!-- <script>
    let myDropzone = new Dropzone("div#myId", { url: "/target"});
    Dropzone.options.myGreatDropzone = { // camelized version of the `id`
        paramName: "file", // The name that will be used to transfer the file
        maxFilesize: 2, // MB
        accept: function(file, done) {
            if (file.name == "justinbieber.jpg") {
                done("Naha, you don't.");
            }
            else { done(); }
            }
        };
</script> -->


<!-- this.on('thumbnail', function(file) {
    if (file.accepted !== false) {
        if (file.width < 640 || file.height < 480) {
        file.rejectDimensions();
        } else {
        file.acceptDimensions();
        }
    }
    });
},
accept: function(file, done) {
    file.acceptDimensions = done;
    file.rejectDimensions = function() {
    done('The image must be at least 640 x 480px');
    }; -->